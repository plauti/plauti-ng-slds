/*! plauti-ng-slds 2015-11-30 */
var plautiNgSlds=angular.module("plauti-ng-slds",[]);plautiNgSlds.directive("plautiMultiSelect",function(){return{restrict:"E",replace:!0,require:"ngModel",scope:{options:"=",ngModel:"=",ngDisabled:"=",required:"@",nameAttr:"@",valueAttr:"@",ngChange:"&",svgPath:"@",defaultText:"@"},template:'<div class="slds slds-picklist" aria-expanded="true"><button class="slds-button slds-button--neutral slds-picklist__label plauti-select-button" style="width:100%" aria-haspopup="true" ng-click="toggleDropdown($event)" aria-disabled="{{$parent.ngDisabled}}" ng-disabled="ngDisabled"><span class="slds-truncate">{{buttonText}}</span><svg aria-hidden="true" class="slds-icon"><use xlink:href="{{downSvgUrl}}"></use></svg></button><div class="slds-dropdown slds-dropdown--left slds-dropdown--menu" style="width:100%; max-width:100%" ng-show="dropVisible"><ul class="slds-dropdown__list" role="menu"><li ng-repeat="option in options track by $index"  class="slds-dropdown__item" ng-class="{true:\'slds-is-selected\'}[option.$$selected==true]" ng-click="toggleSelection(option,$event)" aria-disabled="{{$parent.ngDisabled}}"><a href="javascript:void(0)" role="menuitemradio" ><p class="slds-truncate"><svg aria-hidden="true" class="slds-icon slds-icon--selected slds-icon--x-small slds-icon-text-default slds-m-right--x-small"><use xlink:href="{{$parent.checkSvgUrl}}"></use></svg>{{option[nameAttr]}}</p></a></li></ul></div></div>',link:function($scope,iElm,iAttr,mdlCtrl){$scope.$watchCollection("options",function(){$scope.applyTranformations()});$scope.$watchCollection("ngModel",function(newValue,oldValue){$scope.applyTranformations();void 0!=newValue&&0!=newValue.length||!$scope.required?mdlCtrl.$setValidity("required",!0):mdlCtrl.$setValidity("required",!1)})},controller:function($scope,$document,$log,$filter,$timeout){function indexOf(array,item){for(var i=0;i<array.length;i++)if(angular.equals(array[i],item))return i;return-1}angular.isUndefined($scope.svgPath)&&($scope.svgPath="/assets/icons/utility-sprite/svg/symbols.svg");$scope.downSvgUrl=$scope.svgPath+"#down";$scope.checkSvgUrl=$scope.svgPath+"#check";$scope.dropVisible=!1;angular.isUndefined($scope.defaultText)&&($scope.defaultText="Select an Option");$scope.toggleDropdown=function(evt){var visibilityToSet=!$scope.dropVisible;$timeout(function(){$scope.dropVisible=visibilityToSet})};$document.on("click",function(){$scope.$apply(function(){$scope.dropVisible=!1})});$scope.applyTranformations=function(){$scope.setSelectedOptions();$scope.setButtonText()};$scope.setSelectedOptions=function(){if(!angular.isUndefined($scope.options))for(var i=0;i<$scope.options.length;i++)angular.isUndefined($scope.ngModel)||-1==indexOf($scope.ngModel,void 0==$scope.valueAttr?$scope.options[i]:$scope.options[i][$scope.valueAttr])?$scope.options[i].$$selected=!1:$scope.options[i].$$selected=!0};$scope.setButtonText=function(){if(void 0!=$scope.ngModel&&angular.isArray($scope.ngModel)&&0!=$scope.ngModel.length)if(angular.isArray($scope.ngModel)&&1==$scope.ngModel.length){var selectedOption=$filter("filter")($scope.options,{$$selected:!0})[0];$scope.buttonText=selectedOption[$scope.nameAttr]}else if(angular.isArray($scope.ngModel)&&$scope.ngModel.length>1){for(var selectedOptions=$filter("filter")($scope.options,{$$selected:!0}),buttonText=selectedOptions[0][$scope.nameAttr],i=1;i<selectedOptions.length;i++)buttonText+=", "+selectedOptions[i][$scope.nameAttr];$scope.buttonText=buttonText}else $log.error('Plauti Multi-Select Directive: "ng-model" value must be undefined or an array object.');else $scope.buttonText=$scope.defaultText};$scope.toggleSelection=function(option,evt){evt.stopPropagation();if(!$scope.ngDisabled){void 0!=$scope.ngModel&&angular.isArray($scope.ngModel)||($scope.ngModel=[]);angular.isUndefined($scope.valueAttr)||(option=option[$scope.valueAttr]);var index=indexOf($scope.ngModel,option);-1==index?$scope.ngModel.push(option):$scope.ngModel.splice(index,1);$timeout(function(){$scope.ngChange()})}}}}});plautiNgSlds.directive("plautiPickList",function(){return{restrict:"E",replace:!0,transclude:!1,require:"ngModel",scope:{options:"=",ngModel:"=",ngDisabled:"=",required:"@",nameAttr:"@",valueAttr:"@",ngChange:"&",ngBlur:"&",svgPath:"@"},template:'<div class="slds slds-grid"><div class="slds-form-element" style="width:100%"><div class="slds-picklist slds-picklist--multi"><ul class="slds-picklist__options slds-picklist__options--multi shown" style="width:100%; margin:0" aria-disabled="{{ngDisabled}}"><li ng-repeat="option in options|filter:{$$selected:false}" class="slds-picklist__item" aria-selected="{{option.$$highlight}}" ng-click="highlight(option,$event)" ng-dblClick="toggleSelect(true,option,$event)"><span class="slds-truncate"><span>{{option[nameAttr]}}</span></span></li></ul></div></div><div class="slds-grid slds-grid--vertical"><button class="slds-button slds-button--icon-container" ng-click="toggleSelect(false)" ng-disabled="ngDisabled"><svg aria-hidden="true" class="slds-button__icon"><use xlink:href="{{leftSvgUrl}}"></use></svg><span class="slds-assistive-text">Arrow left</span></button><button class="slds-button slds-button--icon-container" style="margin:0" ng-click="toggleSelect(true)" ng-disabled="ngDisabled"><svg aria-hidden="true" class="slds-button__icon"><use xlink:href="{{rightSvgUrl}}"></use></svg><span class="slds-assistive-text">Arrow right</span></button></div><div class="slds-form-element" style="width:100%"><div class="slds-picklist slds-picklist--multi"><ul class="slds-picklist__options slds-picklist__options--multi shown" style="width:100%; margin:0" aria-disabled="{{ngDisabled}}"><li ng-repeat="option in options|filter:{$$selected:true}|orderBy:\'$$sortOrder\'" class="slds-picklist__item" aria-selected="{{option.$$highlight}}" ng-click="highlight(option,$event)" ng-dblClick="toggleSelect(false,option,$event)" ><span class="slds-truncate"><span>{{option[nameAttr]}}</span></span></li></ul></div></div><div class="slds-grid slds-grid--vertical"><button class="slds-button slds-button--icon-container" ng-click="changeOrder(true)" ng-disabled="upDisabled"><svg aria-hidden="true" class="slds-button__icon"><use xlink:href="{{upSvgUrl}}"></use></svg><span class="slds-assistive-text">Arrow up</span></button><button class="slds-button slds-button--icon-container" style="margin:0" ng-click="changeOrder(false)" ng-disabled="downDisabled"><svg aria-hidden="true" class="slds-button__icon"><use xlink:href="{{downSvgUrl}}"></use></svg><span class="slds-assistive-text">Arrow down</span></button></div></div>',link:function($scope,iElm,iAttr,mdlCtrl){$scope.$watchCollection("options",function(){$scope.applyTranformations()});$scope.$watchCollection("ngModel",function(newValue,oldValue){$scope.applyTranformations();void 0!=newValue&&0!=newValue.length||!$scope.required?mdlCtrl.$setValidity("required",!0):mdlCtrl.$setValidity("required",!1)});$scope.$watch("ngDisabled",function(){$scope.removeHighlights()})},controller:function($scope,$document,$log,$filter){function indexOf(array,item){for(var i=0;i<array.length;i++)if(angular.equals(array[i],item))return i;return-1}function swap(array,x,y){var b=array[y];array[y]=array[x];array[x]=b}angular.isUndefined($scope.svgPath)&&($scope.svgPath="/assets/icons/utility-sprite/svg/symbols.svg");$scope.leftSvgUrl=$scope.svgPath+"#left";$scope.rightSvgUrl=$scope.svgPath+"#right";$scope.upSvgUrl=$scope.svgPath+"#up";$scope.downSvgUrl=$scope.svgPath+"#down";$scope.upDisabled=!0;$scope.downDisabled=!0;$scope.applyTranformations=function(){$scope.setSelectedOptions()};$scope.setSelectedOptions=function(){if(!angular.isUndefined($scope.options)&&!angular.isUndefined($scope.ngModel))for(var i=0;i<$scope.options.length;i++){var index=indexOf($scope.ngModel,void 0==$scope.valueAttr?$scope.options[i]:$scope.options[i][$scope.valueAttr]);if(angular.isUndefined($scope.ngModel)||-1==index)$scope.options[i].$$selected=!1;else{$scope.options[i].$$selected=!0;$scope.options[i].$$sortOrder=index}angular.isUndefined($scope.options[i].$$highlight)&&($scope.options[i].$$highlight=!1)}};$scope.removeHighlights=function(){if(!angular.isUndefined($scope.options))for(var i=0;i<$scope.options.length;i++)$scope.options[i].$$highlight=!1;$scope.setOrderingActions()};$scope.highlight=function(option,evt){evt.stopPropagation();if(!$scope.ngDisabled){if(!evt.ctrlKey&&!evt.metaKey)for(var optionSiblings=$filter("filter")($scope.options,{$$selected:option.$$selected,$$highlight:!0}),i=0;i<optionSiblings.length;i++)optionSiblings[i].$$highlight=!1;option.$$highlight=!0;$scope.setOrderingActions()}};$scope.setOrderingActions=function(){var selectedHighlighted=$filter("filter")($scope.options,{$$selected:!0,$$highlight:!0});if(1!=selectedHighlighted.length||$scope.ngDisabled){$scope.upDisabled=!0;$scope.downDisabled=!0}else{$scope.upDisabled=!1;$scope.downDisabled=!1;var option=selectedHighlighted[0];angular.isUndefined($scope.valueAttr)||(option=option[$scope.valueAttr]);var index=indexOf($scope.ngModel,option);0==index&&($scope.upDisabled=!0);index==$scope.ngModel.length-1&&($scope.downDisabled=!0)}};$scope.toggleSelect=function(direction,option,evt){if(!$scope.ngDisabled){void 0!=$scope.ngModel&&angular.isArray($scope.ngModel)||($scope.ngModel=[]);angular.isUndefined(option)||$scope.highlight(option,evt);var highlightedOptions=$filter("filter")($scope.options,{$$selected:!direction,$$highlight:!0});if(highlightedOptions.length>0){for(var i=0;i<highlightedOptions.length;i++){var option=highlightedOptions[i];angular.isUndefined($scope.valueAttr)||(option=option[$scope.valueAttr]);if(direction)$scope.ngModel.push(option);else{var index=indexOf($scope.ngModel,option);$scope.ngModel.splice(index,1)}}$scope.removeHighlights();$timeout(function(){$scope.ngChange()})}}};$scope.changeOrder=function(moveUp){var highlightedOptions=$filter("filter")($scope.options,{$$selected:!0,$$highlight:!0}),fireChanged=!1;if(highlightedOptions.length>0)for(var i=0;i<highlightedOptions.length;i++){var option=highlightedOptions[i];angular.isUndefined($scope.valueAttr)||(option=option[$scope.valueAttr]);var index=indexOf($scope.ngModel,option);if(moveUp&&index>0||!moveUp&&index<$scope.ngModel.length-1){fireChanged=!0;swap($scope.ngModel,index,moveUp?index-1:index+1)}}if(fireChanged){$scope.setOrderingActions();$timeout(function(){$scope.ngChange()})}}}}});plautiNgSlds.directive("plautiTimepicker",function($log,$filter){return{restrict:"E",replace:!0,require:"ngModel",template:'<div><select class="slds-select" tabindex="{{tabOrder}}" ng-disabled="ngDisabled" ng-change="selectedTimeChanged()" ng-style="{\'padding-left\':isMeridianFormat?\'2rem\':\'3rem\'}" ng-model="selectedTime" ng-options="time.title for time in times"/></div>',scope:{isMeridianFormat:"=",minStep:"=",ngModel:"=",ngDisabled:"=",tabOrder:"=",ngChange:"&"},link:function($scope,iElm,iAttr,mdlCtrl){var today=new Date;$scope.$watch("ngModel",function(value){if(angular.isUndefined(value)){today.setHours(0,0,0,0);$scope.ngModel=angular.copy(today)}else if(angular.isDate(value)){var hours=value.getHours(),minutes=value.getMinutes();if(minutes%$scope.appliedMinStep==0){today.setHours(hours,minutes,0,0);var filteredTime=$filter("filter")($scope.times,function(value,index,array){return angular.equals(value.value,today)?!0:void 0});angular.isUndefined(filteredTime)||1!=filteredTime.length||($scope.selectedTime=filteredTime[0])}else{minutes-=minutes%$scope.appliedMinStep;today.setHours(hours,minutes,0,0);$scope.ngModel=angular.copy(today)}}else $log.error("Plauti-Timepicker: ng-model needs to be a valid Date object")})},controller:function($scope,$timeout){function getTimeFormatString(datetime){var hours=datetime.getHours(),minutes=datetime.getMinutes(),AMPM="";if($scope.isMeridianFormat){if(0==hours){hours=12;AMPM="am"}else if(12>hours)AMPM="am";else if(12==hours)AMPM="pm";else if(hours>12){hours-=12;AMPM="pm"}}else 10>hours&&(hours="0"+hours);10>minutes&&(minutes="0"+minutes);return hours+":"+minutes+AMPM}var today=new Date,time=new Date,min=0;$scope.appliedMinStep=30;angular.isDefined($scope.minStep)&&60%$scope.minStep!=0?$log.error("Plauit-Timepicker: 60 should be divisible by min-step"):angular.isDefined($scope.minStep)&&($scope.appliedMinStep=angular.copy($scope.minStep));$scope.init=function(){$scope.times=[];time.setHours(0,min,0,0);do{var timeInfo={title:getTimeFormatString(time),value:angular.copy(time)};$scope.times.push(timeInfo);min+=$scope.appliedMinStep;time.setHours(0,min,0,0)}while(today.getDate()==time.getDate())};$scope.selectedTimeChanged=function(){$scope.ngModel=$scope.selectedTime.value;$timeout(function(){$scope.ngChange()})};$scope.init()}}});plautiNgSlds.directive("plautiDatepicker",function($log,$filter){return{restrict:"E",replace:!0,require:"ngModel",template:'<div>    <div class="slds-form-element ">        <div class="slds-form-element__control slds-size--1-of-1">            <div class="slds-input-has-icon slds-input-has-icon--right">                <svg class="slds-input__icon slds-icon-text-default" ng-click="toggleCalendar()" ng-style="{cursor:ngDisabled?\'not-allowed\':\'pointer\'}">                    <use xlink:href="{{eventSvgUrl}}"></use>                </svg>                <input id="date" class="slds-input" type="text" tabindex="{{tabOrder}}" ng-click="toggleCalendar()" ng-disabled="ngDisabled" ng-readonly="true" placeholder="{{dateLabel}}" />            </div>        </div>    </div>    <div class="slds-dropdown slds-dropdown--left slds-datepicker" data-selection="single" ng-show="calendarVisible">        <div class="slds-datepicker__filter slds-grid">            <div class="slds-datepicker__filter--month slds-grid slds-grid--align-spread slds-size--3-of-4">                <div class="slds-align-middle">                    <button class="slds-button slds-button--icon-container" ng-click="prevMonth($event)">                        <svg aria-hidden="true" class="slds-button__icon slds-button__icon--small">                            <use xlink:href="{{leftSvgUrl}}"></use>                        </svg>                        <span class="slds-assistive-text">Previous Month</span>                    </button>                </div>                <h2 id="month" class="slds-align-middle" aria-live="assertive" aria-atomic="true" ng-click="$event.stopPropagation()">{{months[month]}}</h2>                <div class="slds-align-middle">                    <button class="slds-button slds-button--icon-container" ng-click="nextMonth($event)">                        <svg aria-hidden="true" class="slds-button__icon slds-button__icon--small">                            <use xlink:href="{{rightSvgUrl}}"></use>                        </svg>                        <span class="slds-assistive-text">Next Month</span>                    </button>                </div>            </div>            <div class="slds-picklist slds-picklist--fluid slds-shrink-none">                <select ng-model="year" class="slds-select slds-button--neutral slds-picklist__label"  ng-options="year for year in years" ng-click="$event.stopPropagation()" ng-change="yearChanged()"></select>            </div>        </div>        <table class="datepicker__month" role="grid" aria-labelledby="month">            <thead>                <tr id="weekdays">                    <th id="Sunday">                        <abbr title="Sunday">S</abbr>                    </th>                    <th id="Monday">                        <abbr title="Monday">M</abbr>                    </th>                    <th id="Tuesday">                        <abbr title="Tuesday">T</abbr>                    </th>                    <th id="Wednesday">                        <abbr title="Wednesday">W</abbr>                    </th>                    <th id="Thursday">                        <abbr title="Thursday">T</abbr>                    </th>                    <th id="Friday">                        <abbr title="Friday">F</abbr>                    </th>                    <th id="Saturday">                        <abbr title="Saturday">S</abbr>                    </th>                </tr>            </thead>            <tbody>                <tr ng-repeat="week in weeks"><td ng-repeat="date in week" ng-class="getDateClass(date)" ng-click="selectDate(date,$event)" role="gridcell" aria-disabled="{{date.secondary}}"><span class="slds-day">{{date.date}}</span></td></tr>            </tbody>        </table>    </div></div>',scope:{ngModel:"=",ngDisabled:"=",ngChange:"&",startYear:"@",endYear:"@",required:"@",tabOrder:"=",svgPath:"@",dateFormat:"@"},link:function($scope,iElm,iAttr,mdlCtrl){$scope.$watch("ngModel",function(value){if(!angular.isDefined(value)||angular.isDate(value)){void 0==value&&$scope.required?mdlCtrl.$setValidity("required",!1):mdlCtrl.$setValidity("required",!0);if(angular.isDefined(value)){$scope.dateLabel=$filter("date")(value,$scope.dateFormat);if(value.getYear()!=$scope.activeDate.getYear()||value.getMonth()!=$scope.activeDate.getMonth()){var newActiveDate=new Date;newActiveDate.setYear(value.getFullYear());newActiveDate.setMonth(value.getMonth());$scope.activeDate=newActiveDate}}else $scope.dateLabel=$scope.datePlaceholderText}else $log.error("Plauti-Datepicker: ng-model needs to be a valid Date object")})},controller:function($scope,$document,$timeout,$filter){function getDaysInMonth(year,month){var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];return 1!==month||year%4!==0||year%100===0&&year%400!==0?DAYS_IN_MONTH[month]:29}function getDates(startDate,n){for(var date,dates=new Array(n),current=new Date(startDate),i=0;n>i;){date=new Date(current);dates[i++]=date;current.setDate(current.getDate()+1)}return dates}function splitArray(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays}$scope.init=function(){$scope.months=["January","Feburary","March","April","May","June","July","August","September","October","November","December"];$scope.calendarVisible=!1;$scope.activeDate=new Date;$scope.month=$scope.activeDate.getMonth();$scope.year=$scope.activeDate.getFullYear();$scope.weeks=$scope.getWeeksOfMonth($scope.activeDate);$scope.populateYears();$scope.datePlaceholderText="Pick a Date";angular.isUndefined($scope.svgPath)&&($scope.svgPath="/assets/icons/utility-sprite/svg/symbols.svg");$scope.leftSvgUrl=$scope.svgPath+"#left";$scope.rightSvgUrl=$scope.svgPath+"#right";$scope.eventSvgUrl=$scope.svgPath+"#event";angular.isUndefined($scope.dateFormat)&&($scope.dateFormat="MM/dd/yyyy")};$scope.toggleCalendar=function(evt){if(!$scope.ngDisabled){var visibilityToSet=!$scope.calendarVisible;$timeout(function(){$scope.calendarVisible=visibilityToSet})}};$document.on("click",function(){$scope.$apply(function(){$scope.calendarVisible=!1})});$scope.$watch("activeDate",function(){$scope.month=$scope.activeDate.getMonth();$scope.year=$scope.activeDate.getFullYear();$scope.weeks=$scope.getWeeksOfMonth($scope.activeDate)});$scope.nextMonth=function(evt){evt.stopPropagation();$scope.activeDate=new Date($scope.activeDate.setMonth($scope.activeDate.getMonth()+1))};$scope.prevMonth=function(evt){evt.stopPropagation();$scope.activeDate=new Date($scope.activeDate.setMonth($scope.activeDate.getMonth()-1))};$scope.yearChanged=function(){$scope.activeDate=new Date($scope.activeDate.setYear($scope.year))};$scope.selectDate=function(date,evt){if(angular.equals($scope.ngModel,date)||date.secondary)evt.stopPropagation();else{$scope.ngModel=date;$timeout(function(){$scope.ngChange()})}};$scope.getDateClass=function(date){var cls="";angular.equals($scope.ngModel,date)&&(cls+="slds-is-selected");date.secondary&&(cls+=" slds-disabled-text");return cls};$scope.getWeeksOfMonth=function(activeDate){var year=activeDate.getFullYear(),month=activeDate.getMonth(),firstDayOfMonth=new Date(year,month,1),lastDayOfMonth=new Date(year,month,getDaysInMonth(year,month)),numDisplayedFromPreviousMonth=firstDayOfMonth.getDay(),numDisplayedFromNextMonth=6-lastDayOfMonth.getDay(),totalDaysToDisplay=numDisplayedFromPreviousMonth+getDaysInMonth(year,month)+numDisplayedFromNextMonth,firstDate=new Date(firstDayOfMonth);numDisplayedFromPreviousMonth>0&&firstDate.setDate(-numDisplayedFromPreviousMonth+1);for(var days=getDates(firstDate,totalDaysToDisplay),i=0;totalDaysToDisplay>i;i++)days[i]=angular.extend(days[i],{secondary:days[i].getMonth()!==month,date:days[i].getDate()});return splitArray(days,7)};$scope.populateYears=function(){$scope.years=[];var startYear=2e3,endYear=2099;angular.isDefined($scope.startYear)&&(startYear=parseInt($scope.startYear));angular.isDefined($scope.endYear)&&(endYear=parseInt($scope.endYear));for(var i=startYear;endYear>=i;i++)$scope.years.push(i)};$scope.init()}}});plautiNgSlds.directive("plautiDatetimepicker",function($log,$timeout){return{restrict:"E",replace:!0,require:"ngModel",scope:{ngModel:"=",ngDisabled:"=",ngChange:"&",startYear:"@",endYear:"@",required:"@",svgPath:"@",tabOrder:"=",isMeridianFormat:"=",minStep:"=",name:"@",dateFormat:"@"},template:'<div class="slds-form--compound"><div class="slds-form-element__row"><plauti-datepicker class="slds-form-element__control slds-size--2-of-3" style="vertical-align:top" ng-model="datepart" ng-disabled="ngDisabled" name="{{name+\'-date\'}}" ng-change="dateChanged()" start-year="{{startYear}}" end-year="{{endYear}}" svg-path="{{svgPath}}" date-format="{{dateFormat}}"></plauti-datepicker><plauti-timepicker class="slds-form-element__control slds-size--1-of-3" ng-model="timepart" ng-disabled="ngDisabled" is-meridian-format="isMeridianFormat" name="{{name+\'-time\'}}" min-step="minStep" ng-change="timeChanged()"></plauti-timepicker></div></div>',link:function($scope,iElm,iAttr,mdlCtrl){$scope.$watch("ngModel",function(value){if(!angular.isDefined(value)||angular.isDate(value)){void 0==value&&$scope.required?mdlCtrl.$setValidity("required",!1):mdlCtrl.$setValidity("required",!0);$scope.datepart=$scope.ngModel;$scope.timepart=$scope.ngModel}else $log.error("Plauti-Datetimepicker: ng-model needs to be a valid Date object")});$scope.dateChanged=function(){var newDateTime=angular.copy($scope.datepart);newDateTime.setHours($scope.timepart.getHours(),$scope.timepart.getMinutes(),0,0);$scope.ngModel=newDateTime;$timeout(function(){$scope.ngChange()})};$scope.timeChanged=function(){if(angular.isDefined($scope.datepart)){var newDateTime=angular.copy($scope.datepart);newDateTime.setHours($scope.timepart.getHours(),$scope.timepart.getMinutes(),0,0);$scope.ngModel=newDateTime;$timeout(function(){$scope.ngChange()})}}}}});plautiNgSlds.directive("plautiTypeahead",function($timeout,$log){return{restrict:"E",replace:!0,require:"ngModel",template:'<div class="slds-lookup">    <div class="slds-form-element">        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">            <svg aria-hidden="true" class="slds-input__icon">                <use xlink:href="{{searchSvgUrl}}"></use>            </svg>            <div class="slds-pill__container slds-hide"></div>            <input class="slds-input slds-show" tabindex="{{tabOrder}}" type="text" ng-disabled="ngDisabled" ng-model="searchText" ng-change="queryChanged()" ng-keydown="highlightOption($event)" ng-click="$event.preventDefault(); $event.stopPropagation();" />        </div>    </div>    <div class="slds-lookup__menu" role="listbox" ng-show="dropActive">        <div class="slds-lookup__item" ng-show="isLoading">            <svg aria-hidden="true" class="slds-icon slds-icon-text-default slds-icon--small">                <use xlink:href="{{spinnerSvgUrl}}"></use>            </svg>&nbsp;&nbsp;Loading Options...        </div>        <div class="slds-lookup__item" ng-show="noData">            &nbsp;&nbsp;No Data Found        </div>        <ul class="slds-lookup__list" role="presentation">            <li class="slds-lookup__item" ng-repeat="option in options track by $index" ng-class="{true:\'active\'}[$index==$parent.activeIndex]" aria-selected="{{$index==$parent.activeIndex}}">                <a href="#" role="option" ng-click="selectOption(option,$event);">                    <svg aria-hidden="true" class="slds-icon {{option[iconCssAttr]}} slds-icon--small">                        <use xlink:href="{{option[iconAttr]}}"></use>                    </svg>{{option[nameAttr]}}                </a>            </li>        </ul>    </div></div>',scope:{ngModel:"=",ngModelDisplay:"=",ngDisabled:"=",required:"@",tabOrder:"=",svgPath:"@",options:"=",valueAttr:"@",nameAttr:"@",typeaheadSelectOnBlur:"=",iconAttr:"@",iconCssAttr:"@",typeaheadWaitMs:"@",typeaheadMinLength:"@",typeaheadOptionsMethod:"&",typeaheadOnSelect:"&"},link:function($scope,iElm,iAttr,mdlCtrl){$scope.listElement=angular.element(iElm[0].querySelector(".slds-lookup__list"))[0];$scope.$watch("ngModel",function(value){angular.isDefined(value)?mdlCtrl.$setValidity("required",!0):$scope.required&&mdlCtrl.$setValidity("required",!1)});$scope.$watch("ngModelDisplay",function(value){angular.isDefined(value)?$scope.searchText=value:$scope.dropActive||($scope.searchText="")});$scope.$watchCollection("options",function(value){$scope.isLoading=!1;if(angular.isUndefined($scope.options)||0==$scope.options.length)$scope.noData=!0;else if($scope.dropActive){$scope.noData=!1;if(1==$scope.options.length&&$scope.options[0][$scope.nameAttr]==$scope.searchText){$scope.ngModelDisplay=$scope.options[0][$scope.nameAttr];$scope.ngModel=angular.isDefined($scope.valueAttr)?$scope.options[0][$scope.valueAttr]:$scope.options[0];$scope.dropActive=!1}$scope.activeIndex=0}})},controller:function($scope,$document){var timeoutPromise,cancelPreviousTimeout=function(){timeoutPromise&&$timeout.cancel(timeoutPromise)};$scope.init=function(){angular.isUndefined($scope.typeaheadWaitMs)&&($scope.typeaheadWaitMs=0);angular.isUndefined($scope.typeaheadMinLength)&&($scope.typeaheadMinLength=1);angular.isUndefined($scope.svgPath)&&($scope.svgPath="/assets/icons/utility-sprite/svg/symbols.svg");$scope.searchSvgUrl=$scope.svgPath+"#search";$scope.spinnerSvgUrl=$scope.svgPath+"#spinner"};$scope.queryChanged=function(){$scope.ngModel=void 0;$scope.ngModelDisplay=void 0;if($scope.searchText.length>=$scope.typeaheadMinLength){cancelPreviousTimeout();timeoutPromise=$timeout($scope.fireSearch,$scope.typeaheadWaitMs)}else{$scope.dropActive=!1;$scope.options=angular.noob}};$scope.fireSearch=function(){$scope.options=angular.noob;$timeout(function(){$scope.isLoading=!0;$scope.dropActive=!0;$scope.noData=!1});$scope.typeaheadOptionsMethod({searchText:$scope.searchText})};$scope.highlightOption=function(evt){if(!angular.isUndefined($scope.options))if("Down"==evt.keyIdentifier||9==evt.keyCode&&!evt.shiftKey){evt.preventDefault();if($scope.activeIndex<$scope.options.length-1){$scope.activeIndex++;$scope.scrollToView()}}else if("Up"==evt.keyIdentifier||9==evt.keyCode&&evt.shiftKey){evt.preventDefault();if($scope.activeIndex>0){$scope.activeIndex--;$scope.scrollToView()}}};$scope.scrollToView=function(){var scrollTop=$scope.listElement.scrollTop,listHeight=$scope.listElement.clientHeight,itemHeight=$scope.listElement.querySelector("li").clientHeight,itemsInView=listHeight/itemHeight,startIndexInView=scrollTop/itemHeight;startIndexInView-=scrollTop%itemHeight==0?0:1;endIndexInView=startIndexInView+itemsInView-1-(scrollTop%itemHeight==0?0:1);$scope.activeIndex<startIndexInView?scrollTop-=itemHeight*(startIndexInView-$scope.activeIndex-1)+(scrollTop%itemHeight==0?itemHeight:itemHeight):$scope.activeIndex>endIndexInView&&(scrollTop+=itemHeight*($scope.activeIndex-endIndexInView)-scrollTop%itemHeight);$scope.listElement.scrollTop=scrollTop};$document.on("click",function(){if($scope.typeaheadSelectOnBlur&&$scope.dropActive){if(angular.isUndefined($scope.options)||0==$scope.options.length){$scope.searchText="";$scope.destroy();return}$scope.ngModel=angular.isDefined($scope.valueAttr)?$scope.options[$scope.activeIndex][$scope.valueAttr]:$scope.options[$scope.activeIndex];$scope.ngModelDisplay=$scope.options[$scope.activeIndex][$scope.nameAttr];$timeout(function(){$scope.typeaheadOnSelect()})}else angular.isUndefined($scope.ngModel)&&($scope.searchText="");$scope.destroy()});$scope.selectOption=function(option,evt){$scope.ngModel=angular.isDefined($scope.valueAttr)?option[$scope.valueAttr]:option;$scope.ngModelDisplay=option[$scope.nameAttr];$timeout(function(){$scope.typeaheadOnSelect()});$scope.destroy();evt.stopPropagation()};$scope.destroy=function(){cancelPreviousTimeout();$scope.dropActive=!1;$scope.options=angular.noob;$timeout(function(){$scope.noData=!1})};$scope.init()}}});